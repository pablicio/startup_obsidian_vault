/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => HabitTracker21
});
module.exports = __toCommonJS(main_exports);
var import_obsidian2 = require("obsidian");

// src/HabitTracker.ts
var import_obsidian = require("obsidian");
var PLUGIN_NAME = "Habit Tracker 21";
var DAYS_TO_SHOW = 21;
var DAYS_TO_LOAD = DAYS_TO_SHOW + 1;
var DEFAULT_SETTINGS = () => ({
  path: "Habits",
  lastDisplayedDate: getTodayDate(),
  daysToShow: DAYS_TO_SHOW,
  daysToLoad: DAYS_TO_LOAD,
  rootElement: void 0,
  habitsGoHere: void 0,
  debug: 0
});
var ALLOWED_USER_SETTINGS = ["path", "lastDisplayedDate", "daysToShow", "debug"];
function getTodayDate() {
  const today = new Date();
  const year = today.getFullYear();
  const month = String(today.getMonth() + 1).padStart(2, "0");
  const day = String(today.getDate()).padStart(2, "0");
  return `${year}-${month}-${day}`;
}
var HabitTracker = class {
  constructor(src, el, ctx, app) {
    this.app = app;
    this.id = this.generateUniqueId();
    this.settings = this.loadSettings(src);
    this.settings.rootElement = el;
    const files = this.loadFiles();
    if (files.length === 0) {
      this.renderNoHabitsFoundMessage();
      return;
    }
    console.log(
      `${PLUGIN_NAME} loaded successfully ${files.length} file(s) from ${this.settings.path}`
    );
    this.settings.habitsGoHere = this.renderRoot(el);
    this.renderHeader(this.settings.habitsGoHere);
    files.forEach(async (f) => {
      this.renderHabit(f.path, await this.getHabitEntries(f.path));
    });
    if (this.settings.debug) {
      this.renderDebugData();
    }
  }
  loadFiles() {
    return this.app.vault.getMarkdownFiles().filter((file) => {
      if (!file.path.includes(this.settings.path)) {
        return false;
      }
      return true;
    }).sort((a, b) => a.name.localeCompare(b.name));
  }
  loadSettings(rawSettings) {
    try {
      let settings = Object.assign(
        {},
        DEFAULT_SETTINGS(),
        this.removePrivateSettings(JSON.parse(rawSettings))
      );
      settings.daysToLoad = settings.daysToShow + 1;
      return settings;
    } catch (error) {
      console.log(error);
      new import_obsidian.Notice(
        `${PLUGIN_NAME}: received invalid settings. continuing with default settings`
      );
      return DEFAULT_SETTINGS();
    }
  }
  removePrivateSettings(userSettings) {
    const result = {};
    ALLOWED_USER_SETTINGS.forEach((key) => {
      if (userSettings[key]) {
        result[key] = userSettings[key];
      }
    });
    return result;
  }
  renderDebugData() {
    var _a;
    (_a = this.settings.rootElement) == null ? void 0 : _a.createEl("pre", {
      // get the json printed with indentation
      text: JSON.stringify(this.settings, null, 2)
    });
  }
  renderNoHabitsFoundMessage() {
    var _a;
    (_a = this.settings.rootElement) == null ? void 0 : _a.createEl("div", {
      text: `No habits found under ${this.settings.path}`
    });
  }
  renderRoot(parent) {
    const rootElement = parent.createEl("div", {
      cls: "habit-tracker"
    });
    rootElement.setAttribute("id", this.id);
    rootElement.addEventListener("click", (e) => {
      const target = e.target;
      if (target == null ? void 0 : target.classList.contains("habit-tick")) {
        this.toggleHabit(target);
      }
    });
    return rootElement;
  }
  renderHeader(parent) {
    const header = parent.createEl("div", {
      cls: "habit-tracker__header habit-tracker__row"
    });
    header.createEl("div", {
      text: "",
      cls: "habit-tracker__cell--name habit-tracker__cell"
    });
    const currentDate = this.createDateFromFormat(
      this.settings.lastDisplayedDate
    );
    currentDate.setDate(currentDate.getDate() - this.settings.daysToLoad + 1);
    for (let i = 0; i < this.settings.daysToLoad; i++) {
      const day = currentDate.getDate().toString();
      header.createEl("div", {
        cls: `habit-tracker__cell habit-tracker__cell--${this.getDayOfWeek(
          currentDate
        )}`,
        text: day,
        attr: {
          "data-date": this.getDateId(currentDate)
        }
      });
      currentDate.setDate(currentDate.getDate() + 1);
    }
  }
  async getFrontmatter(path) {
    const file = this.app.vault.getAbstractFileByPath(path);
    if (!file || !(file instanceof import_obsidian.TFile)) {
      new import_obsidian.Notice(`${PLUGIN_NAME}: No file found for path: ${path}`);
      return {};
    }
    try {
      return await this.app.vault.read(file).then((result) => {
        const frontmatter = result.split("---")[1];
        if (!frontmatter)
          return {};
        return (0, import_obsidian.parseYaml)(frontmatter);
      });
    } catch (error) {
      return {};
    }
  }
  async getHabitEntries(path) {
    const fm = await this.getFrontmatter(path);
    return fm.entries || [];
  }
  renderHabit(path, entries) {
    var _a;
    if (!this.settings.habitsGoHere) {
      new import_obsidian.Notice(`${PLUGIN_NAME}: missing div that holds all habits`);
      return null;
    }
    const parent = this.settings.habitsGoHere;
    const name = (_a = path.split("/").pop()) == null ? void 0 : _a.replace(".md", "");
    let row = parent.querySelector(`*[data-id="${this.pathToId(path)}"]`);
    if (!row) {
      row = this.settings.habitsGoHere.createEl("div", {
        cls: "habit-tracker__row"
      });
      row.setAttribute("data-id", this.pathToId(path));
    } else {
      this.removeAllChildNodes(row);
    }
    const habitTitle = row.createEl("div", {
      cls: "habit-tracker__cell--name habit-tracker__cell"
    });
    const habitTitleLink = habitTitle.createEl("a", {
      text: name,
      cls: "internal-link"
    });
    habitTitleLink.setAttribute("href", path);
    habitTitleLink.setAttribute("aria-label", path);
    const currentDate = this.createDateFromFormat(
      this.settings.lastDisplayedDate
    );
    currentDate.setDate(currentDate.getDate() - this.settings.daysToLoad + 1);
    const entriesSet = new Set(entries);
    for (let i = 0; i < this.settings.daysToLoad; i++) {
      const dateString = this.getDateId(currentDate);
      const isTicked = entriesSet.has(dateString);
      const habitCell = row.createEl("div", {
        cls: `habit-tracker__cell
				habit-tick habit-tick--${isTicked}
				habit-tracker__cell--${this.getDayOfWeek(currentDate)}`
      });
      habitCell.setAttribute("ticked", isTicked.toString());
      habitCell.setAttribute("date", dateString);
      habitCell.setAttribute("habit", path);
      habitCell.setAttribute("streak", this.findStreak(entries, currentDate));
      currentDate.setDate(currentDate.getDate() + 1);
    }
  }
  // get streak
  // based on an array of dates, get the current streak for the given date
  findStreak(entries, date) {
    let currentDate = new Date(date);
    let streak = 0;
    while (entries.includes(this.getDateId(currentDate))) {
      streak++;
      currentDate.setDate(currentDate.getDate() - 1);
    }
    return streak.toString();
  }
  async toggleHabit(el) {
    const habit = el.getAttribute("habit");
    const date = el.getAttribute("date");
    const file = this.app.vault.getAbstractFileByPath(habit);
    const isTicked = el.getAttribute("ticked");
    if (!file || !(file instanceof import_obsidian.TFile)) {
      new import_obsidian.Notice(`${PLUGIN_NAME}: file missing while trying to toggle habit`);
      return;
    }
    this.app.fileManager.processFrontMatter(file, (frontmatter) => {
      let entries = frontmatter["entries"] || [];
      if (isTicked === "true") {
        entries = entries.filter((e) => e !== date);
      } else {
        entries.push(date);
        entries.sort();
      }
      frontmatter["entries"] = entries;
    });
    this.renderHabit(file.path, await this.getHabitEntries(file.path));
  }
  writeFile(file, content) {
    if (!content) {
      new import_obsidian.Notice(
        `${PLUGIN_NAME}: could not save changes due to missing content`
      );
      return null;
    }
    if (!file || !(file instanceof import_obsidian.TFile)) {
      new import_obsidian.Notice(
        `${PLUGIN_NAME}: could not save changes due to missing file`
      );
      return null;
    }
    try {
      return this.app.vault.modify(file, content);
    } catch (error) {
      new import_obsidian.Notice(`${PLUGIN_NAME}: could not save changes`);
      return Promise.reject(error);
    }
  }
  removeAllChildNodes(parent) {
    while (parent.firstChild) {
      parent.removeChild(parent.firstChild);
    }
  }
  pathToId(path) {
    return path.replaceAll("/", "_").replaceAll(".", "__").replaceAll(" ", "___");
  }
  createDateFromFormat(dateString) {
    const [year, month, day] = dateString.split("-").map(Number);
    const date = new Date();
    date.setFullYear(year);
    date.setMonth(month - 1);
    date.setDate(day);
    return date;
  }
  getDateId(date) {
    const year = date.getFullYear();
    const month = String(date.getMonth() + 1).padStart(2, "0");
    const day = String(date.getDate()).padStart(2, "0");
    let dateId = `${year}-${month}-${day}`;
    return dateId;
  }
  getDayOfWeek(date) {
    const daysOfWeek = [
      "sunday",
      "monday",
      "tuesday",
      "wednesday",
      "thursday",
      "friday",
      "saturday"
    ];
    const dayIndex = date.getDay();
    const dayName = daysOfWeek[dayIndex];
    return dayName.toLowerCase();
  }
  generateUniqueId() {
    const timestamp = Date.now();
    const randomNum = Math.floor(Math.random() * 1e4);
    return `habittracker-${timestamp}-${randomNum}`;
  }
};

// src/main.ts
var PLUGIN_NAME2 = "Habit Tracker 21";
var HabitTracker21 = class extends import_obsidian2.Plugin {
  async onload() {
    console.log(`${PLUGIN_NAME2}: loading...`);
    this.registerMarkdownCodeBlockProcessor(
      "habittracker",
      async (src, el, ctx) => {
        new HabitTracker(src, el, ctx, this.app);
      }
    );
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL0hhYml0VHJhY2tlci50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHtQbHVnaW59IGZyb20gJ29ic2lkaWFuJ1xuaW1wb3J0IEhhYml0VHJhY2tlciBmcm9tICcuL0hhYml0VHJhY2tlcidcblxuY29uc3QgUExVR0lOX05BTUUgPSAnSGFiaXQgVHJhY2tlciAyMSdcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgSGFiaXRUcmFja2VyMjEgZXh0ZW5kcyBQbHVnaW4ge1xuXHRhc3luYyBvbmxvYWQoKSB7XG5cdFx0Y29uc29sZS5sb2coYCR7UExVR0lOX05BTUV9OiBsb2FkaW5nLi4uYClcblx0XHR0aGlzLnJlZ2lzdGVyTWFya2Rvd25Db2RlQmxvY2tQcm9jZXNzb3IoXG5cdFx0XHQnaGFiaXR0cmFja2VyJyxcblx0XHRcdGFzeW5jIChzcmMsIGVsLCBjdHgpID0+IHtcblx0XHRcdFx0bmV3IEhhYml0VHJhY2tlcihzcmMsIGVsLCBjdHgsIHRoaXMuYXBwKVxuXHRcdFx0fSxcblx0XHQpXG5cdH1cbn1cbiIsICIvLyBXb3JraW5nIHdpdGggZmlsZXMgYW5kIGZvbGRlcnMgaW4geW91ciBwbHVnaW46IGh0dHBzOi8vd3d3LnlvdXR1YmUuY29tL3dhdGNoP3Y9X1FGVU95SUIxbllcbi8vIERpc3BsYXkgZGF0YSBpbiB2aWV3cyBhbmQgc3RhdHVzIGJhcjogaHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2g/dj16Ujg2cGZ0bE9zZyZhYl9jaGFubmVsPU9ic2lkaWFuXG4vLyBFYXN5IGFuZCBmYXN0IFVJIGRldmVsb3BtZW50IHdpdGggU3ZlbHRlOiBodHRwczovL3d3dy55b3V0dWJlLmNvbS93YXRjaD92PW1DRjgwSEJmVVdBJmFiX2NoYW5uZWw9T2JzaWRpYW5cbi8vIGh0dHBzOi8vZ2l0aHViLmNvbS9PbGl2ZXJCYWxmb3VyL29ic2lkaWFuLXBhbmRvYy9ibG9iL21hc3Rlci9yZW5kZXJlci50c1xuLy8gZXhhbXBsZSBvZiByZXBsYWNpbmcgY29kZWJsb2NrcyBodHRwczovL2dpdGh1Yi5jb20vam9sZWFmL29ic2lkaWFuLWVtYWlsLWJsb2NrLXBsdWdpblxuLy8gaHR0cHM6Ly9vdXJncmVlbnN0b3J5LmNvbS9ubC9zdGlja3ktd2hpdGVib2FyZC9oYWJpdC10cmFja2VyL1xuLy8gbGlzdGVuIHRvIGZpbGUgY2hhbmdlIGh0dHBzOi8vZ2l0aHViLmNvbS9vYnNpZGlhbm1kL29ic2lkaWFuLWFwaS9ibG9iL2MwMWZjMzA3NGRlZWIzZGZjNmVlMDI1NDZkMTEzYjQ0ODczNWIyOTQvb2JzaWRpYW4uZC50cyNMMzcyNFxuXG5pbXBvcnQge0FwcCwgcGFyc2VZYW1sLCBOb3RpY2UsIFRBYnN0cmFjdEZpbGUsIFRGaWxlfSBmcm9tICdvYnNpZGlhbidcblxuY29uc3QgUExVR0lOX05BTUUgPSAnSGFiaXQgVHJhY2tlciAyMSdcbi8qIGkgd2FudCB0byBzaG93IHRoYXQgYSBzdHJlYWsgaXMgYWxyZWFkeSBvbmdvaW5nIGV2ZW4gaWYgdGhlIHByZXZpb3VzIGRhdGVzIGFyZSBub3QgcmVuZGVyZWRcbiAgc28gSSBsb2FkIGFuIGV4dHJhIGRhdGUgaW4gdGhlIHJhbmdlLCBidXQgbmV2ZXIgZGlzcGxheSBpdCBpbiB0aGUgVUkgKi9cbmNvbnN0IERBWVNfVE9fU0hPVyA9IDIxXG5jb25zdCBEQVlTX1RPX0xPQUQgPSBEQVlTX1RPX1NIT1cgKyAxXG5cbmludGVyZmFjZSBIYWJpdFRyYWNrZXJTZXR0aW5ncyB7XG5cdHBhdGg6IHN0cmluZ1xuXHRsYXN0RGlzcGxheWVkRGF0ZTogc3RyaW5nXG5cdGRheXNUb1Nob3c6IG51bWJlclxuXHRkYXlzVG9Mb2FkOiBudW1iZXJcblx0cm9vdEVsZW1lbnQ6IEhUTUxEaXZFbGVtZW50IHwgdW5kZWZpbmVkXG5cdGhhYml0c0dvSGVyZTogSFRNTERpdkVsZW1lbnQgfCB1bmRlZmluZWRcblx0ZGVidWc6IG51bWJlclxufVxuXG5jb25zdCBERUZBVUxUX1NFVFRJTkdTID0gKCk6IEhhYml0VHJhY2tlclNldHRpbmdzID0+ICh7XG5cdHBhdGg6ICdIYWJpdHMnLFxuXHRsYXN0RGlzcGxheWVkRGF0ZTogZ2V0VG9kYXlEYXRlKCksXG5cdGRheXNUb1Nob3c6IERBWVNfVE9fU0hPVyxcblx0ZGF5c1RvTG9hZDogREFZU19UT19MT0FELFxuXHRyb290RWxlbWVudDogdW5kZWZpbmVkLFxuXHRoYWJpdHNHb0hlcmU6IHVuZGVmaW5lZCxcblx0ZGVidWc6IDAsXG59KVxuXG5jb25zdCBBTExPV0VEX1VTRVJfU0VUVElOR1MgPSBbJ3BhdGgnLCAnbGFzdERpc3BsYXllZERhdGUnLCAnZGF5c1RvU2hvdycsICdkZWJ1ZyddXG5cbmZ1bmN0aW9uIGdldFRvZGF5RGF0ZSgpIHtcblx0Y29uc3QgdG9kYXkgPSBuZXcgRGF0ZSgpXG5cdGNvbnN0IHllYXIgPSB0b2RheS5nZXRGdWxsWWVhcigpXG5cdGNvbnN0IG1vbnRoID0gU3RyaW5nKHRvZGF5LmdldE1vbnRoKCkgKyAxKS5wYWRTdGFydCgyLCAnMCcpXG5cdGNvbnN0IGRheSA9IFN0cmluZyh0b2RheS5nZXREYXRlKCkpLnBhZFN0YXJ0KDIsICcwJylcblxuXHRyZXR1cm4gYCR7eWVhcn0tJHttb250aH0tJHtkYXl9YFxufVxuXG5mdW5jdGlvbiBnZXREYXlzRGlmZmVyZW5jZShzdGFydERhdGVJZCwgZW5kRGF0ZUlkKSB7XG5cdGNvbnN0IHN0YXJ0ID0gbmV3IERhdGUoc3RhcnREYXRlSWQpXG5cdGNvbnN0IGVuZCA9IG5ldyBEYXRlKGVuZERhdGVJZClcblx0Y29uc3Qgb25lRGF5ID0gMjQgKiA2MCAqIDYwICogMTAwMCAvLyBob3VycyAqIG1pbnV0ZXMgKiBzZWNvbmRzICogbWlsbGlzZWNvbmRzXG5cblx0Y29uc3QgZGlmZkluVGltZSA9IE1hdGguYWJzKGVuZC5nZXRUaW1lKCkgLSBzdGFydC5nZXRUaW1lKCkpXG5cdGNvbnN0IGRpZmZJbkRheXMgPSBNYXRoLnJvdW5kKGRpZmZJblRpbWUgLyBvbmVEYXkpXG5cblx0cmV0dXJuIGRpZmZJbkRheXNcbn1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgSGFiaXRUcmFja2VyIHtcblx0c2V0dGluZ3M6IEhhYml0VHJhY2tlclNldHRpbmdzXG5cdGFwcDogQXBwXG5cdGlkOiBTdHJpbmdcblxuXHRjb25zdHJ1Y3RvcihzcmMsIGVsLCBjdHgsIGFwcCkge1xuXHRcdHRoaXMuYXBwID0gYXBwXG5cdFx0dGhpcy5pZCA9IHRoaXMuZ2VuZXJhdGVVbmlxdWVJZCgpXG5cdFx0dGhpcy5zZXR0aW5ncyA9IHRoaXMubG9hZFNldHRpbmdzKHNyYylcblx0XHR0aGlzLnNldHRpbmdzLnJvb3RFbGVtZW50ID0gZWxcblx0XHQvLyBjb25zb2xlLmxvZyhgJHtQTFVHSU5fTkFNRX0gZ290IHdpdGggdGhlc2Ugc2V0dGluZ3M6YCwgdGhpcy5zZXR0aW5ncylcblxuXHRcdC8vIDEuIGdldCBhbGwgdGhlIGhhYml0c1xuXHRcdGNvbnN0IGZpbGVzID0gdGhpcy5sb2FkRmlsZXMoKVxuXG5cdFx0aWYgKGZpbGVzLmxlbmd0aCA9PT0gMCkge1xuXHRcdFx0dGhpcy5yZW5kZXJOb0hhYml0c0ZvdW5kTWVzc2FnZSgpXG5cdFx0XHRyZXR1cm5cblx0XHR9XG5cblx0XHRjb25zb2xlLmxvZyhcblx0XHRcdGAke1BMVUdJTl9OQU1FfSBsb2FkZWQgc3VjY2Vzc2Z1bGx5ICR7ZmlsZXMubGVuZ3RofSBmaWxlKHMpIGZyb20gJHt0aGlzLnNldHRpbmdzLnBhdGh9YCxcblx0XHQpXG5cblx0XHQvLyAyLjEgcmVuZGVyIHRoZSBlbGVtZW50IHRoYXQgaG9sZHMgYWxsIGhhYml0c1xuXHRcdHRoaXMuc2V0dGluZ3MuaGFiaXRzR29IZXJlID0gdGhpcy5yZW5kZXJSb290KGVsKVxuXG5cdFx0Ly8gMi4yIHJlbmRlciB0aGUgaGVhZGVyXG5cdFx0dGhpcy5yZW5kZXJIZWFkZXIodGhpcy5zZXR0aW5ncy5oYWJpdHNHb0hlcmUpXG5cblx0XHQvLyAyLjMgcmVuZGVyIGVhY2ggaGFiaXRcblx0XHRmaWxlcy5mb3JFYWNoKGFzeW5jIChmKSA9PiB7XG5cdFx0XHR0aGlzLnJlbmRlckhhYml0KGYucGF0aCwgYXdhaXQgdGhpcy5nZXRIYWJpdEVudHJpZXMoZi5wYXRoKSlcblx0XHR9KVxuXG5cdFx0aWYgKHRoaXMuc2V0dGluZ3MuZGVidWcpIHtcblx0XHR0aGlzLnJlbmRlckRlYnVnRGF0YSgpO1xuXHR9XG5cdH1cblxuXHRsb2FkRmlsZXMoKSB7XG5cdFx0cmV0dXJuIHRoaXMuYXBwLnZhdWx0XG5cdFx0XHQuZ2V0TWFya2Rvd25GaWxlcygpXG5cdFx0XHQuZmlsdGVyKChmaWxlKSA9PiB7XG5cdFx0XHRcdC8vIG9ubHkgaGFiaXRzXG5cdFx0XHRcdGlmICghZmlsZS5wYXRoLmluY2x1ZGVzKHRoaXMuc2V0dGluZ3MucGF0aCkpIHtcblx0XHRcdFx0XHQvLyBjb25zb2xlLmxvZyhgJHtmaWxlLnBhdGh9IGRvZXNuJ3QgbWF0Y2ggJHt0aGlzLnNldHRpbmdzLnBhdGh9YCk7XG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlXG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyZXR1cm4gdHJ1ZVxuXHRcdFx0fSlcblx0XHRcdC5zb3J0KChhLCBiKSA9PiBhLm5hbWUubG9jYWxlQ29tcGFyZShiLm5hbWUpKVxuXHR9XG5cblx0bG9hZFNldHRpbmdzKHJhd1NldHRpbmdzKSB7XG5cdFx0dHJ5IHtcblx0XHRcdGxldCBzZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oXG5cdFx0XHRcdHt9LFxuXHRcdFx0XHRERUZBVUxUX1NFVFRJTkdTKCksXG5cdFx0XHRcdHRoaXMucmVtb3ZlUHJpdmF0ZVNldHRpbmdzKEpTT04ucGFyc2UocmF3U2V0dGluZ3MpKSxcblx0XHRcdClcblx0XHRcdC8qIGkgd2FudCB0byBzaG93IHRoYXQgYSBzdHJlYWsgaXMgYWxyZWFkeSBvbmdvaW5nIGV2ZW4gaWYgdGhlIHByZXZpb3VzIGRhdGVzIGFyZSBub3QgcmVuZGVyZWRcbiAgXHRcdHNvIEkgbG9hZCBhbiBleHRyYSBkYXRlIGluIHRoZSByYW5nZSwgYnV0IG5ldmVyIGRpc3BsYXkgaXQgaW4gdGhlIFVJICovXG5cdFx0XHRzZXR0aW5ncy5kYXlzVG9Mb2FkID0gc2V0dGluZ3MuZGF5c1RvU2hvdyArIDFcblx0XHRcdHJldHVybiBzZXR0aW5nc1xuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRjb25zb2xlLmxvZyhlcnJvcik7XG5cdFx0XHRuZXcgTm90aWNlKFxuXHRcdFx0XHRgJHtQTFVHSU5fTkFNRX06IHJlY2VpdmVkIGludmFsaWQgc2V0dGluZ3MuIGNvbnRpbnVpbmcgd2l0aCBkZWZhdWx0IHNldHRpbmdzYCxcblx0XHRcdClcblx0XHRcdHJldHVybiBERUZBVUxUX1NFVFRJTkdTKClcblx0XHR9XG5cdH1cblxuXHRyZW1vdmVQcml2YXRlU2V0dGluZ3ModXNlclNldHRpbmdzKSB7XG5cdFx0Y29uc3QgcmVzdWx0ID0ge31cblx0XHRBTExPV0VEX1VTRVJfU0VUVElOR1MuZm9yRWFjaCgoa2V5KSA9PiB7XG5cdFx0XHRpZiAodXNlclNldHRpbmdzW2tleV0pIHtcblx0XHRcdFx0cmVzdWx0W2tleV0gPSB1c2VyU2V0dGluZ3Nba2V5XVxuXHRcdFx0fVxuXHRcdH0pXG5cblx0XHRyZXR1cm4gcmVzdWx0XG5cdH1cblxuXHRyZW5kZXJEZWJ1Z0RhdGEoKSB7XG5cdFx0dGhpcy5zZXR0aW5ncy5yb290RWxlbWVudD8uY3JlYXRlRWwoJ3ByZScsIHtcblx0XHRcdC8vIGdldCB0aGUganNvbiBwcmludGVkIHdpdGggaW5kZW50YXRpb25cblx0XHRcdHRleHQ6IEpTT04uc3RyaW5naWZ5KHRoaXMuc2V0dGluZ3MsIG51bGwsIDIpLFxuXHRcdH0pXG5cdH1cblxuXHRyZW5kZXJOb0hhYml0c0ZvdW5kTWVzc2FnZSgpIHtcblx0XHR0aGlzLnNldHRpbmdzLnJvb3RFbGVtZW50Py5jcmVhdGVFbCgnZGl2Jywge1xuXHRcdFx0dGV4dDogYE5vIGhhYml0cyBmb3VuZCB1bmRlciAke3RoaXMuc2V0dGluZ3MucGF0aH1gLFxuXHRcdH0pXG5cdH1cblxuXHRyZW5kZXJSb290KHBhcmVudCkge1xuXHRcdGNvbnN0IHJvb3RFbGVtZW50ID0gcGFyZW50LmNyZWF0ZUVsKCdkaXYnLCB7XG5cdFx0XHRjbHM6ICdoYWJpdC10cmFja2VyJyxcblx0XHR9KVxuXHRcdHJvb3RFbGVtZW50LnNldEF0dHJpYnV0ZSgnaWQnLCB0aGlzLmlkKVxuXHRcdHJvb3RFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcblx0XHRcdGNvbnN0IHRhcmdldCA9IGUudGFyZ2V0IGFzIEhUTUxEaXZFbGVtZW50XG5cdFx0XHRpZiAodGFyZ2V0Py5jbGFzc0xpc3QuY29udGFpbnMoJ2hhYml0LXRpY2snKSkge1xuXHRcdFx0XHR0aGlzLnRvZ2dsZUhhYml0KHRhcmdldClcblx0XHRcdH1cblx0XHR9KVxuXG5cdFx0cmV0dXJuIHJvb3RFbGVtZW50XG5cdH1cblxuXHRyZW5kZXJIZWFkZXIocGFyZW50KSB7XG5cdFx0Y29uc3QgaGVhZGVyID0gcGFyZW50LmNyZWF0ZUVsKCdkaXYnLCB7XG5cdFx0XHRjbHM6ICdoYWJpdC10cmFja2VyX19oZWFkZXIgaGFiaXQtdHJhY2tlcl9fcm93Jyxcblx0XHR9KVxuXG5cdFx0aGVhZGVyLmNyZWF0ZUVsKCdkaXYnLCB7XG5cdFx0XHR0ZXh0OiAnJyxcblx0XHRcdGNsczogJ2hhYml0LXRyYWNrZXJfX2NlbGwtLW5hbWUgaGFiaXQtdHJhY2tlcl9fY2VsbCcsXG5cdFx0fSlcblxuXHRcdGNvbnN0IGN1cnJlbnREYXRlID0gdGhpcy5jcmVhdGVEYXRlRnJvbUZvcm1hdChcblx0XHRcdHRoaXMuc2V0dGluZ3MubGFzdERpc3BsYXllZERhdGUsXG5cdFx0KVxuXHRcdGN1cnJlbnREYXRlLnNldERhdGUoY3VycmVudERhdGUuZ2V0RGF0ZSgpIC0gdGhpcy5zZXR0aW5ncy5kYXlzVG9Mb2FkICsgMSlcblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuc2V0dGluZ3MuZGF5c1RvTG9hZDsgaSsrKSB7XG5cdFx0XHRjb25zdCBkYXkgPSBjdXJyZW50RGF0ZS5nZXREYXRlKCkudG9TdHJpbmcoKVxuXHRcdFx0aGVhZGVyLmNyZWF0ZUVsKCdkaXYnLCB7XG5cdFx0XHRcdGNsczogYGhhYml0LXRyYWNrZXJfX2NlbGwgaGFiaXQtdHJhY2tlcl9fY2VsbC0tJHt0aGlzLmdldERheU9mV2Vlayhcblx0XHRcdFx0XHRjdXJyZW50RGF0ZSxcblx0XHRcdFx0KX1gLFxuXHRcdFx0XHR0ZXh0OiBkYXksXG5cdFx0XHRcdGF0dHI6IHtcblx0XHRcdFx0XHQnZGF0YS1kYXRlJzogdGhpcy5nZXREYXRlSWQoY3VycmVudERhdGUpLFxuXHRcdFx0XHR9LFxuXHRcdFx0fSlcblx0XHRcdGN1cnJlbnREYXRlLnNldERhdGUoY3VycmVudERhdGUuZ2V0RGF0ZSgpICsgMSlcblx0XHR9XG5cdH1cblxuXHRhc3luYyBnZXRGcm9udG1hdHRlcihwYXRoOiBzdHJpbmcpIHtcblx0XHRjb25zdCBmaWxlOiBUQWJzdHJhY3RGaWxlfG51bGwgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocGF0aClcblxuXHRcdGlmICghZmlsZSB8fCAhKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkgKSB7XG5cdFx0XHRuZXcgTm90aWNlKGAke1BMVUdJTl9OQU1FfTogTm8gZmlsZSBmb3VuZCBmb3IgcGF0aDogJHtwYXRofWApXG5cdFx0XHRyZXR1cm4ge31cblx0XHR9XG5cblx0XHR0cnkge1xuXHRcdFx0cmV0dXJuIGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSkudGhlbigocmVzdWx0KSA9PiB7XG5cdFx0XHRcdGNvbnN0IGZyb250bWF0dGVyID0gcmVzdWx0LnNwbGl0KCctLS0nKVsxXVxuXG5cdFx0XHRcdGlmICghZnJvbnRtYXR0ZXIpIHJldHVybiB7fVxuXG5cdFx0XHRcdHJldHVybiBwYXJzZVlhbWwoZnJvbnRtYXR0ZXIpXG5cdFx0XHR9KVxuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRyZXR1cm4ge31cblx0XHR9XG5cdH1cblxuXHRhc3luYyBnZXRIYWJpdEVudHJpZXMocGF0aDogc3RyaW5nKSB7XG5cdFx0Ly8gbGV0IGVudHJpZXMgPSBhd2FpdCB0aGlzLmdldEZyb250bWF0dGVyKHBhdGgpPy5lbnRyaWVzIHx8IFtdO1xuXHRcdGNvbnN0IGZtID0gYXdhaXQgdGhpcy5nZXRGcm9udG1hdHRlcihwYXRoKVxuXHRcdC8vIGNvbnNvbGUubG9nKGBGb3VuZCAke2ZtLmVudHJpZXN9IGZvciAke3BhdGh9YCk7XG5cdFx0cmV0dXJuIGZtLmVudHJpZXMgfHwgW11cblx0fVxuXG5cdHJlbmRlckhhYml0KHBhdGg6IHN0cmluZywgZW50cmllczogc3RyaW5nW10pIHtcblx0XHQvLyBjb25zb2xlLmxvZygncmVuZGVyaW5nIGEgaGFiaXQnKVxuXHRcdGlmICghdGhpcy5zZXR0aW5ncy5oYWJpdHNHb0hlcmUpIHtcblx0XHRcdG5ldyBOb3RpY2UoYCR7UExVR0lOX05BTUV9OiBtaXNzaW5nIGRpdiB0aGF0IGhvbGRzIGFsbCBoYWJpdHNgKVxuXHRcdFx0cmV0dXJuIG51bGxcblx0XHR9XG5cdFx0Y29uc3QgcGFyZW50ID0gdGhpcy5zZXR0aW5ncy5oYWJpdHNHb0hlcmVcblxuXHRcdGNvbnN0IG5hbWUgPSBwYXRoLnNwbGl0KCcvJykucG9wKCk/LnJlcGxhY2UoJy5tZCcsICcnKVxuXG5cdFx0Ly8gbm8uIHRoaXMgbmVlZHMgdG8gYmUgcXVlcmllZCBpbnNpZGUgdGhpcy5zZXR0aW5ncy5yb290RWxlbWVudDtcblx0XHRsZXQgcm93ID0gcGFyZW50LnF1ZXJ5U2VsZWN0b3IoYCpbZGF0YS1pZD1cIiR7dGhpcy5wYXRoVG9JZChwYXRoKX1cIl1gKVxuXG5cdFx0aWYgKCFyb3cpIHtcblx0XHRcdHJvdyA9IHRoaXMuc2V0dGluZ3MuaGFiaXRzR29IZXJlLmNyZWF0ZUVsKCdkaXYnLCB7XG5cdFx0XHRcdGNsczogJ2hhYml0LXRyYWNrZXJfX3JvdycsXG5cdFx0XHR9KVxuXHRcdFx0cm93LnNldEF0dHJpYnV0ZSgnZGF0YS1pZCcsIHRoaXMucGF0aFRvSWQocGF0aCkpXG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMucmVtb3ZlQWxsQ2hpbGROb2Rlcyhyb3cpXG5cdFx0fVxuXG5cdFx0Y29uc3QgaGFiaXRUaXRsZSA9IHJvdy5jcmVhdGVFbCgnZGl2Jywge1xuXHRcdFx0Y2xzOiAnaGFiaXQtdHJhY2tlcl9fY2VsbC0tbmFtZSBoYWJpdC10cmFja2VyX19jZWxsJyxcblx0XHR9KVxuXG5cdFx0Y29uc3QgaGFiaXRUaXRsZUxpbmsgPSBoYWJpdFRpdGxlLmNyZWF0ZUVsKCdhJywge1xuXHRcdFx0dGV4dDogbmFtZSxcblx0XHRcdGNsczogJ2ludGVybmFsLWxpbmsnLFxuXHRcdH0pXG5cblx0XHRoYWJpdFRpdGxlTGluay5zZXRBdHRyaWJ1dGUoJ2hyZWYnLCBwYXRoKVxuXHRcdGhhYml0VGl0bGVMaW5rLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsIHBhdGgpXG5cblx0XHRjb25zdCBjdXJyZW50RGF0ZSA9IHRoaXMuY3JlYXRlRGF0ZUZyb21Gb3JtYXQoXG5cdFx0XHR0aGlzLnNldHRpbmdzLmxhc3REaXNwbGF5ZWREYXRlLFxuXHRcdClcblx0XHRjdXJyZW50RGF0ZS5zZXREYXRlKGN1cnJlbnREYXRlLmdldERhdGUoKSAtIHRoaXMuc2V0dGluZ3MuZGF5c1RvTG9hZCArIDEpIC8vIHRvZG8sIHdoeSArMT9cblxuXHRcdGNvbnN0IGVudHJpZXNTZXQgPSBuZXcgU2V0KGVudHJpZXMpXG5cblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuc2V0dGluZ3MuZGF5c1RvTG9hZDsgaSsrKSB7XG5cdFx0XHRjb25zdCBkYXRlU3RyaW5nID0gdGhpcy5nZXREYXRlSWQoY3VycmVudERhdGUpXG5cdFx0XHRjb25zdCBpc1RpY2tlZCA9IGVudHJpZXNTZXQuaGFzKGRhdGVTdHJpbmcpXG5cblx0XHRcdGNvbnN0IGhhYml0Q2VsbCA9IHJvdy5jcmVhdGVFbCgnZGl2Jywge1xuXHRcdFx0XHRjbHM6IGBoYWJpdC10cmFja2VyX19jZWxsXG5cdFx0XHRcdGhhYml0LXRpY2sgaGFiaXQtdGljay0tJHtpc1RpY2tlZH1cblx0XHRcdFx0aGFiaXQtdHJhY2tlcl9fY2VsbC0tJHt0aGlzLmdldERheU9mV2VlayhjdXJyZW50RGF0ZSl9YCxcblx0XHRcdH0pXG5cblx0XHRcdGhhYml0Q2VsbC5zZXRBdHRyaWJ1dGUoJ3RpY2tlZCcsIGlzVGlja2VkLnRvU3RyaW5nKCkpXG5cblx0XHRcdGhhYml0Q2VsbC5zZXRBdHRyaWJ1dGUoJ2RhdGUnLCBkYXRlU3RyaW5nKVxuXHRcdFx0aGFiaXRDZWxsLnNldEF0dHJpYnV0ZSgnaGFiaXQnLCBwYXRoKVxuXG5cdFx0XHRoYWJpdENlbGwuc2V0QXR0cmlidXRlKCdzdHJlYWsnLCB0aGlzLmZpbmRTdHJlYWsoZW50cmllcywgY3VycmVudERhdGUpKVxuXG5cdFx0XHRjdXJyZW50RGF0ZS5zZXREYXRlKGN1cnJlbnREYXRlLmdldERhdGUoKSArIDEpXG5cdFx0fVxuXHR9XG5cblx0Ly8gZ2V0IHN0cmVha1xuXHQvLyBiYXNlZCBvbiBhbiBhcnJheSBvZiBkYXRlcywgZ2V0IHRoZSBjdXJyZW50IHN0cmVhayBmb3IgdGhlIGdpdmVuIGRhdGVcblx0ZmluZFN0cmVhayhlbnRyaWVzLCBkYXRlKSB7XG5cdFx0bGV0IGN1cnJlbnREYXRlID0gbmV3IERhdGUoZGF0ZSk7XG5cdFx0bGV0IHN0cmVhayA9IDBcblxuXHRcdC8vIGNvbnNvbGUubG9nKCdlbnRyaWVzJywgZW50cmllcylcblx0XHQvLyBjb25zb2xlLmxvZygnZGF0ZScsIGRhdGUpXG5cblx0XHR3aGlsZSAoZW50cmllcy5pbmNsdWRlcyh0aGlzLmdldERhdGVJZChjdXJyZW50RGF0ZSkpKSB7XG5cdFx0XHRzdHJlYWsrK1xuXHRcdFx0Y3VycmVudERhdGUuc2V0RGF0ZShjdXJyZW50RGF0ZS5nZXREYXRlKCkgLSAxKVxuXHRcdH1cblxuXHRcdHJldHVybiBzdHJlYWsudG9TdHJpbmcoKTtcblx0fVxuXG5cdGFzeW5jIHRvZ2dsZUhhYml0KGVsKSB7XG5cdFx0Y29uc3QgaGFiaXQgPSBlbC5nZXRBdHRyaWJ1dGUoJ2hhYml0Jylcblx0XHRjb25zdCBkYXRlID0gZWwuZ2V0QXR0cmlidXRlKCdkYXRlJylcblx0XHRjb25zdCBmaWxlOiBUQWJzdHJhY3RGaWxlfG51bGwgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoaGFiaXQpXG5cdFx0Y29uc3QgaXNUaWNrZWQgPSBlbC5nZXRBdHRyaWJ1dGUoJ3RpY2tlZCcpXG5cblx0XHRpZiAoIWZpbGUgfHwhKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkpIHtcblx0XHRcdG5ldyBOb3RpY2UoYCR7UExVR0lOX05BTUV9OiBmaWxlIG1pc3Npbmcgd2hpbGUgdHJ5aW5nIHRvIHRvZ2dsZSBoYWJpdGApXG5cdFx0XHRyZXR1cm5cblx0XHR9XG5cblx0XHR0aGlzLmFwcC5maWxlTWFuYWdlci5wcm9jZXNzRnJvbnRNYXR0ZXIoZmlsZSwgKGZyb250bWF0dGVyKSA9PiB7XG5cdFx0XHRsZXQgZW50cmllcyA9IGZyb250bWF0dGVyWydlbnRyaWVzJ10gfHwgW11cblx0XHRcdGlmIChpc1RpY2tlZCA9PT0gJ3RydWUnKSB7XG5cdFx0XHRcdGVudHJpZXMgPSBlbnRyaWVzLmZpbHRlcigoZSkgPT4gZSAhPT0gZGF0ZSlcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGVudHJpZXMucHVzaChkYXRlKVxuXHRcdFx0XHRlbnRyaWVzLnNvcnQoKVxuXHRcdFx0fVxuXHRcdFx0ZnJvbnRtYXR0ZXJbJ2VudHJpZXMnXSA9IGVudHJpZXNcblx0XHR9KVxuXG5cdFx0dGhpcy5yZW5kZXJIYWJpdChmaWxlLnBhdGgsIGF3YWl0IHRoaXMuZ2V0SGFiaXRFbnRyaWVzKGZpbGUucGF0aCkpXG5cdH1cblxuXHR3cml0ZUZpbGUoZmlsZTogVEFic3RyYWN0RmlsZSwgY29udGVudDogc3RyaW5nKSB7XG5cdFx0aWYgKCFjb250ZW50KSB7XG5cdFx0XHRuZXcgTm90aWNlKFxuXHRcdFx0XHRgJHtQTFVHSU5fTkFNRX06IGNvdWxkIG5vdCBzYXZlIGNoYW5nZXMgZHVlIHRvIG1pc3NpbmcgY29udGVudGAsXG5cdFx0XHQpXG5cdFx0XHRyZXR1cm4gbnVsbFxuXHRcdH1cblxuXHRcdGlmICghZmlsZSB8fCEoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkge1xuXHRcdFx0bmV3IE5vdGljZShcblx0XHRcdFx0YCR7UExVR0lOX05BTUV9OiBjb3VsZCBub3Qgc2F2ZSBjaGFuZ2VzIGR1ZSB0byBtaXNzaW5nIGZpbGVgLFxuXHRcdFx0KVxuXHRcdFx0cmV0dXJuIG51bGxcblx0XHR9XG5cblx0XHR0cnkge1xuXHRcdFx0cmV0dXJuIHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCBjb250ZW50KVxuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRuZXcgTm90aWNlKGAke1BMVUdJTl9OQU1FfTogY291bGQgbm90IHNhdmUgY2hhbmdlc2ApXG5cdFx0XHRyZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpXG5cdFx0fVxuXHR9XG5cblx0cmVtb3ZlQWxsQ2hpbGROb2RlcyhwYXJlbnQpIHtcblx0XHR3aGlsZSAocGFyZW50LmZpcnN0Q2hpbGQpIHtcblx0XHRcdHBhcmVudC5yZW1vdmVDaGlsZChwYXJlbnQuZmlyc3RDaGlsZClcblx0XHR9XG5cdH1cblxuXHRwYXRoVG9JZChwYXRoKSB7XG5cdFx0cmV0dXJuIHBhdGhcblx0XHRcdC5yZXBsYWNlQWxsKCcvJywgJ18nKVxuXHRcdFx0LnJlcGxhY2VBbGwoJy4nLCAnX18nKVxuXHRcdFx0LnJlcGxhY2VBbGwoJyAnLCAnX19fJylcblx0fVxuXG5cdGNyZWF0ZURhdGVGcm9tRm9ybWF0KGRhdGVTdHJpbmcpIHtcblx0XHRjb25zdCBbeWVhciwgbW9udGgsIGRheV0gPSBkYXRlU3RyaW5nLnNwbGl0KCctJykubWFwKE51bWJlcilcblx0XHRjb25zdCBkYXRlID0gbmV3IERhdGUoKVxuXG5cdFx0ZGF0ZS5zZXRGdWxsWWVhcih5ZWFyKVxuXHRcdGRhdGUuc2V0TW9udGgobW9udGggLSAxKVxuXHRcdGRhdGUuc2V0RGF0ZShkYXkpXG5cblx0XHRyZXR1cm4gZGF0ZVxuXHR9XG5cblx0Z2V0RGF0ZUlkKGRhdGUpIHtcblx0XHRjb25zdCB5ZWFyID0gZGF0ZS5nZXRGdWxsWWVhcigpXG5cdFx0Y29uc3QgbW9udGggPSBTdHJpbmcoZGF0ZS5nZXRNb250aCgpICsgMSkucGFkU3RhcnQoMiwgJzAnKVxuXHRcdGNvbnN0IGRheSA9IFN0cmluZyhkYXRlLmdldERhdGUoKSkucGFkU3RhcnQoMiwgJzAnKVxuXG5cdFx0bGV0IGRhdGVJZCA9IGAke3llYXJ9LSR7bW9udGh9LSR7ZGF5fWBcblxuXHRcdHJldHVybiBkYXRlSWRcblx0fVxuXG5cdGdldERheU9mV2VlayhkYXRlKSB7XG5cdFx0Y29uc3QgZGF5c09mV2VlayA9IFtcblx0XHRcdCdzdW5kYXknLFxuXHRcdFx0J21vbmRheScsXG5cdFx0XHQndHVlc2RheScsXG5cdFx0XHQnd2VkbmVzZGF5Jyxcblx0XHRcdCd0aHVyc2RheScsXG5cdFx0XHQnZnJpZGF5Jyxcblx0XHRcdCdzYXR1cmRheScsXG5cdFx0XVxuXHRcdGNvbnN0IGRheUluZGV4ID0gZGF0ZS5nZXREYXkoKVxuXHRcdGNvbnN0IGRheU5hbWUgPSBkYXlzT2ZXZWVrW2RheUluZGV4XVxuXHRcdHJldHVybiBkYXlOYW1lLnRvTG93ZXJDYXNlKClcblx0fVxuXG5cdGdlbmVyYXRlVW5pcXVlSWQoKSB7XG5cdFx0Y29uc3QgdGltZXN0YW1wID0gRGF0ZS5ub3coKVxuXHRcdGNvbnN0IHJhbmRvbU51bSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMDAwKSAvLyBBZGp1c3QgdGhlIHJhbmdlIGFzIG5lZWRlZFxuXHRcdHJldHVybiBgaGFiaXR0cmFja2VyLSR7dGltZXN0YW1wfS0ke3JhbmRvbU51bX1gXG5cdH1cbn1cbiJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxJQUFBQSxtQkFBcUI7OztBQ1FyQixzQkFBMkQ7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S0FBSyxJQUFJLE1BQU0sT0FBTyxNQUFNLE9BQU87QUFBQSxJQUMzQyxTQUFTLE9BQVA7QUFDRCxVQUFJLHVCQUFPLEdBQUcscUNBQXFDO0FBQ25ELGFBQU8sUUFBUSxPQUFPLEtBQUs7QUFBQSxJQUM1QjtBQUFBLEVBQ0Q7QUFBQSxFQUVBLG9CQUFvQixRQUFRO0FBQzNCLFdBQU8sT0FBTyxZQUFZO0FBQ3pCLGFBQU8sWUFBWSxPQUFPLFVBQVU7QUFBQSxJQUNyQztBQUFBLEVBQ0Q7QUFBQSxFQUVBLFNBQVMsTUFBTTtBQUNkLFdBQU8sS0FDTCxXQUFXLEtBQUssR0FBRyxFQUNuQixXQUFXLEtBQUssSUFBSSxFQUNwQixXQUFXLEtBQUssS0FBSztBQUFBLEVBQ3hCO0FBQUEsRUFFQSxxQkFBcUIsWUFBWTtBQUNoQyxVQUFNLENBQUMsTUFBTSxPQUFPLEdBQUcsSUFBSSxXQUFXLE1BQU0sR0FBRyxFQUFFLElBQUksTUFBTTtBQUMzRCxVQUFNLE9BQU8sSUFBSSxLQUFLO0FBRXRCLFNBQUssWUFBWSxJQUFJO0FBQ3JCLFNBQUssU0FBUyxRQUFRLENBQUM7QUFDdkIsU0FBSyxRQUFRLEdBQUc7QUFFaEIsV0FBTztBQUFBLEVBQ1I7QUFBQSxFQUVBLFVBQVUsTUFBTTtBQUNmLFVBQU0sT0FBTyxLQUFLLFlBQVk7QUFDOUIsVUFBTSxRQUFRLE9BQU8sS0FBSyxTQUFTLElBQUksQ0FBQyxFQUFFLFNBQVMsR0FBRyxHQUFHO0FBQ3pELFVBQU0sTUFBTSxPQUFPLEtBQUssUUFBUSxDQUFDLEVBQUUsU0FBUyxHQUFHLEdBQUc7QUFFbEQsUUFBSSxTQUFTLEdBQUcsUUFBUSxTQUFTO0FBRWpDLFdBQU87QUFBQSxFQUNSO0FBQUEsRUFFQSxhQUFhLE1BQU07QUFDbEIsVUFBTSxhQUFhO0FBQUEsTUFDbEI7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxNQUNBO0FBQUEsTUFDQTtBQUFBLE1BQ0E7QUFBQSxJQUNEO0FBQ0EsVUFBTSxXQUFXLEtBQUssT0FBTztBQUM3QixVQUFNLFVBQVUsV0FBVyxRQUFRO0FBQ25DLFdBQU8sUUFBUSxZQUFZO0FBQUEsRUFDNUI7QUFBQSxFQUVBLG1CQUFtQjtBQUNsQixVQUFNLFlBQVksS0FBSyxJQUFJO0FBQzNCLFVBQU0sWUFBWSxLQUFLLE1BQU0sS0FBSyxPQUFPLElBQUksR0FBSztBQUNsRCxXQUFPLGdCQUFnQixhQUFhO0FBQUEsRUFDckM7QUFDRDs7O0FEdlpBLElBQU1DLGVBQWM7QUFFcEIsSUFBcUIsaUJBQXJCLGNBQTRDLHdCQUFPO0FBQUEsRUFDbEQsTUFBTSxTQUFTO0FBQ2QsWUFBUSxJQUFJLEdBQUdBLDBCQUF5QjtBQUN4QyxTQUFLO0FBQUEsTUFDSjtBQUFBLE1BQ0EsT0FBTyxLQUFLLElBQUksUUFBUTtBQUN2QixZQUFJLGFBQWEsS0FBSyxJQUFJLEtBQUssS0FBSyxHQUFHO0FBQUEsTUFDeEM7QUFBQSxJQUNEO0FBQUEsRUFDRDtBQUNEOyIsCiAgIm5hbWVzIjogWyJpbXBvcnRfb2JzaWRpYW4iLCAiUExVR0lOX05BTUUiXQp9Cg==
